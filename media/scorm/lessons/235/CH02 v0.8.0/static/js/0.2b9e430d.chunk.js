(this["webpackJsonpall-in-one"]=this["webpackJsonpall-in-one"]||[]).push([[0],{814:function(e,t,n){"use strict";n.r(t);var i,r=n(6),s=n(7),a=n(764),o=n.n(a),c="[,]",u="[.]",d="choice",p="fill-in",l="matching",f="other",h="http://adlnet.gov/expapi/activities/course",v="http://adlnet.gov/expapi/activities/objective",b="http://adlnet.gov/expapi/activities/cmi.interaction",m="http://easygenerator/expapi/course/id",y="http://easygenerator/expapi/question/survey",x="http://easygenerator/expapi/question/type",S="http://easygenerator/expapi/question/imageUrl",w="http://easygenerator/expapi/question/content",g="http://easygenerator/expapi/question/answers",j={started:{id:"http://adlnet.gov/expapi/verbs/launched",display:{"en-US":"started"}},stopped:{id:"http://adlnet.gov/expapi/verbs/exited",display:{"en-US":"stopped"}},passed:{id:"http://adlnet.gov/expapi/verbs/passed",display:{"en-US":"passed"}},failed:{id:"http://adlnet.gov/expapi/verbs/failed",display:{"en-US":"failed"}},experienced:{id:"http://adlnet.gov/expapi/verbs/experienced",display:{"en-US":"experienced"}},answered:{id:"http://adlnet.gov/expapi/verbs/answered",display:{"en-US":"answered"}},mastered:{id:"http://adlnet.gov/expapi/verbs/mastered",display:{"en-US":"mastered"}},progressed:{id:"http://adlnet.gov/expapi/verbs/progressed",display:{"en-US":"progressed"}},evaluated:{id:"http://www.tincanapi.co.uk/verbs/evaluated",display:{"en-US":"evaluated"}}},O=n(9),E=n(27),A=n(147),k=function(e){var t=R((e/=1e3)/3600),n=R((e-=3600*t)/60),i=R(e-=60*n);return"PT".concat(t,"H").concat(n,"M").concat(i,"S")},R=function(e){return parseInt(e,10)},U=function(e){return new o.a.Activity({id:Object(A.e)(e.id),definition:new o.a.ActivityDefinition({type:v,name:{"en-US":e.title}})})},P=function(e){var t=e.score,n=e.omitScore,i=void 0!==n&&n,r=e.response,s=e.duration;return new o.a.Result(Object(O.a)({},!i&&{score:new o.a.Score({scaled:t/100})},{},r&&{response:r},{},s&&{duration:k(s)}))},N=new(function(){function e(){Object(r.a)(this,e),this.courseId=void 0,this.sessionId=void 0,this.course=void 0,this.actor=void 0,this.lrs=void 0,this.nps=void 0}return Object(s.a)(e,[{key:"initialize",value:function(e){var t=e.course,n=e.actor;this.courseId=t.id,this.sessionId=t.attemptId,this.course=t,this.actor=n}},{key:"initializeLrs",value:function(e,t){this.lrs=new o.a,this.initializeInstance(this.lrs,this.getLrsRecordStore(e,t))}},{key:"initializeNps",value:function(e){this.nps=new o.a,this.initializeInstance(this.nps,this.getNpsRecordStore(e))}},{key:"initializeInstance",value:function(e,t){var n;e.addRecordStore(t),e.actor=this.getActor(this.actor),e.activity=(n=this.course.title,new o.a.Activity({id:Object(E.e)(),definition:new o.a.ActivityDefinition({type:h,name:{"en-US":n}})})),e.context=this.getDefaultContext()}},{key:"getLrsRecordStore",value:function(e,t){var n=e.lrs.uri;return this.isDefaultLrs(e)&&(n="".concat(t,"/xApi")),new o.a.LRS({endpoint:n,version:e.version,username:e.lrs.credentials.username,password:e.lrs.credentials.password,allowFail:!1})}},{key:"getNpsRecordStore",value:function(e){return new o.a.LRS({endpoint:"".concat(e,"/xApi"),username:"",password:"",allowFail:!1})}},{key:"getActor",value:function(e){var t=e.username,n=e.email,i=e.account;return i?new o.a.Agent({name:t||i.name,account:i}):new o.a.Agent({name:t,mbox:"mailto:".concat(n)})}},{key:"getDefaultContext",value:function(){return this.extendContext(new o.a.Context({contextActivities:new o.a.ContextActivities({})}))}},{key:"extendContext",value:function(e){return e.extensions=e.extensions||{},e.extensions[m]=this.courseId,e.registration=this.sessionId,e}},{key:"isDefaultLrs",value:function(e){return"default"===e.selectedLrs}}]),e}()),L=n(12),C=n(10),H=n(13),T=n(14),D=n(3),I=n.n(D),z=n(157),_=n(28),q=n(36),F=(i={},Object(_.a)(i,q.b.PASSED,j.passed),Object(_.a)(i,q.b.FAILED,j.failed),Object(_.a)(i,q.b.IN_PROGRESS,j.progressed),i),V=function(){return{verb:j.started}},G=function(e){var t=e.course,n=e.timeSpent,i=e.xapiStatus;return{verb:F[i],result:P({score:t.score,duration:n})}},J=function(e){var t=e.score,n=e.response;return{verb:j.evaluated,result:P({score:t,response:n})}},M=n(95),Q=function(e){var t=e.section,n=e.xapiStatus;return{verb:Object(M.b)(n)?j.progressed:j.mastered,object:U(t),result:P({score:t.score})}},W=n(51),X=n(18),B=function(e){return{response:e.answers.filter((function(t){return e.response.indexOf(t.id)>=0})).map((function(e){return e.id})).join(c),correctResponsesPattern:e.type===X.j?e.correctAnswerId:e.answers.filter((function(e){return e.isCorrect})).map((function(e){return e.id})).join(c),interactionType:d,extraActivityDefinition:{choices:e.answers.map((function(t){return{id:t.id,description:{"en-US":e.type===X.j?t.image:t.text}}}))}}},K=function(e,t){return{response:Object.keys(e.response.data).map((function(t){return"".concat(e.response.data[t]).concat(u).concat(t)})).join(c),correctResponsesPattern:e.answerGroups.map((function(e){return e.answers.filter((function(e){return e.isCorrect})).map((function(t){return"".concat(t.text).concat(u).concat(e.id)})).join(c)})).join(c),interactionType:p,extensions:Object(_.a)({},w,t[0].value)}},Y=function(e){return{response:e.response.answeredText,omitScore:!0,interactionType:f}},Z=function(e){return{response:e.response.map((function(e){return"".concat(e.id).concat(u).concat(e.isCorrect)})).join(c),correctResponsesPattern:e.answers.map((function(e){return"".concat(e.id).concat(u).concat(e.isCorrect)})).join(c),interactionType:d,extraActivityDefinition:{choices:e.answers.map((function(e){return{id:e.id,description:{"en-US":e.text}}}))}}},$=function(e){return{response:e.response.map((function(e){return e.text})).join(c),correctResponsesPattern:e.answers.map((function(e){return e.text})).join(c),interactionType:d,extraActivityDefinition:{choices:e.answers.map((function(e){return{id:e.text,description:{"en-US":e.text}}}))}}},ee=function(e){var t=function(e){return e.map((function(e,t){return{id:t.toString(),description:{"en-US":e}}}))},n=e.answers.map((function(e){return e.key})),i=e.answers.map((function(e){return e.value})).filter((function(e,t,n){return n.indexOf(e)===t})),r=e.answers.map((function(e){return"".concat(n.indexOf(e.key)).concat(u).concat(i.indexOf(e.value))})).join(c);return{response:n.map((function(t,n){var r=e.response.find((function(e){return e.key===t})),s="";return r&&r.shownSelectedValue&&(s=i.indexOf(r.shownSelectedValue)),"".concat(n).concat(u).concat(s)})).join(c),correctResponsesPattern:r,interactionType:l,extraActivityDefinition:{source:t(n),target:t(i)}}},te=function(){return{interactionType:f}},ne=function(e){var t,n=e.dropspots.map((function(e){return e.text})).join(c),i=e.dropspots.map((function(e){return"(".concat(e.x,",").concat(e.y,")")})).join(c);return{response:e.dropspots.map((function(t){var n=e.response.find((function(e){return e.id===t.id}));if(!n)return"(-1,-1)";var i=n.items.length&&n.items[0];if(!i)return"(-1,-1)";var r=e.dropspots.find((function(e){return e.id===i.id}));return"(".concat(r.x,",").concat(r.y,")")})).join(c),correctResponsesPattern:i,interactionType:f,extensions:(t={},Object(_.a)(t,S,e.background),Object(_.a)(t,g,n),t)}},ie=function(e){return{response:e.response.map((function(e){return"(".concat(e.x,",").concat(e.y,")")})).join(c),correctResponsesPattern:e.spots.map((function(e){return e.map((function(e){return"(".concat(e.x,",").concat(e.y,")")})).join(u)})).join(c),interactionType:f,extensions:Object(_.a)({},S,e.background)}},re=function(e){var t=Object(W.a)(e,3),n=t[0],i=t[1],r=t[2];return se(n,i,function(e){switch(e.type){case X.i:case X.e:case X.j:return B;case X.b:return K;case X.f:return Y;case X.k:return Z;case X.g:return $;case X.l:return ee;case X.h:return te;case X.a:return ne;case X.c:return ie;default:throw new Error("Question type ".concat(e.type," is not supported"))}}(n)(n,r))};function se(e,t,n){var i=n.response,r=n.correctResponsesPattern,s=n.interactionType,a=n.extraActivityDefinition,c=n.omitScore,u=n.extensions,d=n.verb,p=function(e,t){var n;return N.extendContext(new o.a.Context({contextActivities:new o.a.ContextActivities({parent:[U(t)]}),extensions:(n={},Object(_.a)(n,y,e.hasOwnProperty("isSurvey")&&e.isSurvey),Object(_.a)(n,x,e.type),n)}))}(e,t);p.extensions=Object.assign(p.extensions,u);var l=Object(O.a)({name:{"en-US":e.title},type:b,interactionType:s},r&&{correctResponsesPattern:e.isSurvey?[]:[r]});return l=Object.assign(l,a),{context:p,verb:d||j.answered,object:new o.a.Activity({id:Object(A.c)(t.id,e.id),definition:new o.a.ActivityDefinition(l)}),result:P({score:e.score,omitScore:c,response:i})}}var ae=function(e){var t=Object(W.a)(e,2);return se(t[0],t[1],{interactionType:f,verb:j.experienced})},oe=new function e(){var t=this;Object(r.a)(this,e),this.courseStarted=void 0,this.courseProgressed=void 0,this.courseEvaluated=void 0,this.sectionProgressed=void 0,this.questionAnswered=void 0,this.informationContentExperienced=void 0,this.listStatement=void 0,this.listStatement=[{name:"courseStarted",instance:V},{name:"courseProgressed",instance:G},{name:"courseEvaluated",instance:J},{name:"sectionProgressed",instance:Q},{name:"questionAnswered",instance:re},{name:"informationContentExperienced",instance:ae}],this.listStatement.forEach((function(e){t[e.name]=function(){return new o.a.Statement(e.instance.apply(e,arguments))}}))},ce=function(e){console.error("xApi error: [ ".concat(ue(e)," ]"))};function ue(e){return e?e.code&&e.mesg?"code: ".concat(e.code,", message: ").concat(e.mesg):e.toString():"undefined error"}var de=function(e){function t(e){var n,i=e.sendStatement,s=e.shouldHandlerErrors;return Object(r.a)(this,t),(n=Object(L.a)(this,Object(C.a)(t).call(this))).handlers=void 0,n.sendStatement=void 0,n.shouldHandlerErrors=void 0,n.handlers=[],n.sendStatement=i,n.shouldHandlerErrors=s,n}return Object(H.a)(t,e),Object(s.a)(t,[{key:"createHandler",value:function(e){var t=this;return function(n){return I.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,I.a.awrap(t.handle(e,n));case 2:case"end":return i.stop()}}))}}},{key:"handle",value:function(e,t){var n;return I.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,n=oe[e](t),i.next=4,I.a.awrap(this.sendStatement(n));case 4:i.next=13;break;case 6:if(i.prev=6,i.t0=i.catch(0),!this.shouldHandlerErrors){i.next=12;break}ce(i.t0),i.next=13;break;case 12:throw i.t0;case 13:case"end":return i.stop()}}),null,this,[[0,6]])}}]),t}(z.a),pe=n(59),le=new(function(){function e(){Object(r.a)(this,e),this.statements=void 0,this.statements=[]}return Object(s.a)(e,[{key:"push",value:function(e){this.statements.push(e)}},{key:"shift",value:function(){var e=this.statements;return this.statements=[],e}}]),e}()),fe=!0,he=new(function(){function e(){Object(r.a)(this,e),this.settings=void 0,this.promises=void 0,this.batchSize=void 0}return Object(s.a)(e,[{key:"initialize",value:function(e){this.settings=e,this.promises=[],this.batchSize=5}},{key:"sendLrsStatement",value:function(e){if(N.isDefaultLrs(this.settings)||this.isAllowedStatement(e))return le.push(e),this.sendStorageStatements(),Promise.all(this.promises)}},{key:"sendNpsStatement",value:function(e){this.doSend(N.nps.sendStatements.bind(N.nps),[e])}},{key:"isAllowedStatement",value:function(e){return this.settings.allowedVerbs.indexOf(e.verb.display["en-US"])>=0}},{key:"sendStorageStatements",value:function(){var e=le.shift();if(0!==e.length)for(;e.length;){var t=e.splice(0,this.batchSize);this.promises.push(this.doSend(N.lrs.sendStatements.bind(N.lrs),t))}}},{key:"doSend",value:function(e,t){var n=this;return new Promise((function(n,i){e(t,(function(e){if(e){var t=e.find((function(e){return null!==e.err}));t?i(t.err):(!fe&&T.a.emit(T.b.APP_ONLINE),fe=!0,n())}}))})).catch((function(){setTimeout((function(){fe&&T.a.emit(T.b.APP_OFFLINE_OR_SERVER_ERROR),fe=!1,n.doSend(e,t)}),pe.a)}))}}]),e}()),ve=function(e){function t(){return Object(r.a)(this,t),Object(L.a)(this,Object(C.a)(t).call(this,{sendStatement:he.sendLrsStatement.bind(he),shouldHandlerErrors:!0}))}return Object(H.a)(t,e),Object(s.a)(t,[{key:"initialize",value:function(e){var t=e.isScoringOfContentPagesAllowed;this.handlers=[{event:T.b.COURSE_STARTED,instance:this.createHandler("courseStarted")},{event:T.b.COURSE_PROGRESSED,instance:this.createHandler("courseProgressed")},{event:T.b.SECTION_PROGRESSED,instance:this.createHandler("sectionProgressed")},{event:T.b.QUESTION_ANSWERED,instance:this.createHandler("questionAnswered")}],t&&this.handlers.push({event:T.b.INFORMATION_CONTENT_EXPERIENCED,instance:this.createHandler("informationContentExperienced")})}}]),t}(de),be=function(e){function t(){return Object(r.a)(this,t),Object(L.a)(this,Object(C.a)(t).call(this,{sendStatement:he.sendNpsStatement.bind(he)}))}return Object(H.a)(t,e),Object(s.a)(t,[{key:"initialize",value:function(){this.handlers=[{event:T.b.COURSE_EVALUATED,instance:this.createHandler("courseEvaluated")}]}}]),t}(de),me=function(){function e(){Object(r.a)(this,e),this.lrsEventHandler=void 0,this.npsEventHandler=void 0,this.settings=void 0,this.defaultLrsUrl=void 0,this.defaultNpsUrl=void 0,this.lrsEventHandler=new ve,this.npsEventHandler=new be}return Object(s.a)(e,[{key:"subscribeLrs",value:function(){try{N.initializeLrs(this.settings.xApi,this.defaultLrsUrl)}catch(e){this.unsubscribeLrs(),ce(e)}this.lrsEventHandler.on()}},{key:"subscribeNps",value:function(){try{N.initializeNps(this.defaultNpsUrl)}catch(e){this.unsubscribeNps(),function(e){console.error("xApi error: [ ".concat(ue(e)," ]"))}(e)}this.npsEventHandler.on()}},{key:"unsubscribeLrs",value:function(){this.lrsEventHandler.off()}},{key:"unsubscribeNps",value:function(){this.npsEventHandler.off()}},{key:"unsubscribeAll",value:function(){this.unsubscribeLrs(),this.unsubscribeNps()}},{key:"initialize",value:function(e){var t=e.settings,n=e.defaultLrsUrl,i=e.defaultNpsUrl,r=e.course,s=e.actor;this.settings=t,this.defaultLrsUrl=n,this.defaultNpsUrl=i,this.lrsEventHandler.initialize(t),this.npsEventHandler.initialize(),N.initialize({course:r,actor:s}),he.initialize(t.xApi)}}]),e}();t.default=new me}}]);
//# sourceMappingURL=0.2b9e430d.chunk.js.map